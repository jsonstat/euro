// jsonstat-euro v1.0.5 Copyright 2019 Xavier Badosa https://jsonstat.com
var EuroJSONstat=function(e,t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var r="en",a="2.1";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e,t){var l=JSON.parse(JSON.stringify(e));return n(l,"filter")&&(Object.keys(l.filter).forEach((function(e){l.filter[e]=l.filter[e].slice(0,1)})),!0===t&&(delete l.filter.time,l.filter.lastTimePeriod=["1"])),n(l,"label")&&n(l.label,"category")&&(Object.keys(l.label.category).forEach((function(e){l.label.category[e]=l.label.category[e].slice(0,1)})),!0===t&&delete l.label.category.time),l.class="query",l.lang=e.lang?e.lang:r,l.version=e.version?e.version:a,l}function i(e){var t=JSON.parse(JSON.stringify(e));return n(t,"filter")?(delete t.filter.time,t.filter.lastTimePeriod=["1"]):t.filter={lastTimePeriod:["1"]},t.class="query",t.lang=e.lang?e.lang:r,t.version=e.version?e.version:a,t}function o(e,t,l){void 0===l&&(l=Object.keys(t),t=function(e,t,n){return{class:"query",dataset:null,filter:e,lang:t||r,version:n||a}}(t));var i=JSON.parse(JSON.stringify(e)),o=n(t,"filter"),s=n(t,"label")&&n(t.label,"category");return l.forEach((function(e){o&&n(t.filter,e)&&(n(i,"filter")||(i.filter={}),i.filter[e]=t.filter[e]),s&&n(t.label.category,e)&&(n(i,"label")?n(i.label,"category")||(i.label.category={}):i.label={},i.label.category[e]=t.label.category[e])})),i.class="query",i.lang=e.lang?e.lang:r,i.version=e.version?e.version:a,i}function s(e,t){var l=JSON.parse(JSON.stringify(e)),i=n(l,"filter"),o=n(l,"label"),s=o&&n(l.label,"category"),c=o&&n(l.label,"dimension");return t.forEach((function(e){i&&delete l.filter[e],o&&(s&&delete l.label.category[e],c&&delete l.label.dimension[e])})),l.class="query",l.lang=e.lang?e.lang:r,l.version=e.version?e.version:a,l}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){if("string"==typeof e){if(/https?:\/\//i.test(e))return e;e={dataset:e}}if("object"===c(e)&&null!==e&&!Array.isArray(e)&&e.dataset){var t=e.filter||null,n=e.lang||r,l=e.version||a,i="".concat("https://ec.europa.eu/eurostat/wdds/rest/data/","v").concat(l,"/json/").concat(n,"/").concat(e.dataset),o=[];return t&&(Object.keys(t).forEach((function(e){var r=t[e];Array.isArray(r)?r.forEach((function(t){o.push("".concat(e,"=").concat(t))})):o.push("".concat(e,"=").concat(r))})),i+="?"+o.join("&")),i}return null}function f(e){e.role={geo:[],time:[],metric:[],classification:[]},e.id.forEach((function(t){switch(e.Dimension(t).role="time"===t||"geo"===t?t:"classification",t){case"geo":case"time":e.role[t].push(t);break;case"unit":case"s_adj":e.role.metric.push(t);break;default:e.role.classification.push(t)}}))}function y(e){if(e)return t(u(e)).then((function(e){return"dataset"===e.class?(f(e),e):e}),(function(e){var t=e.message.slice(0,3),r=isNaN(t)?"418":t;return{class:"error",status:r,label:"418"!==r?e.message.slice(4):e.message}}))}function g(e,t){"string"==typeof e&&(e={dataset:e});var n=!1!==t?i(e):e;return y(n).then((function(e){if("error"===e.class)return e;var t={},l={},i={};return e.id.forEach((function(r){var a=e.Dimension(r);l[r]=a.label,t[r]=a.id,i[r]=a.Category().map((function(e){return e.label}))})),{class:"query",dataset:n.dataset,filter:t,label:{dataset:e.label,dimension:l,category:i},lang:n.lang||r,version:n.version||a}}))}return e.addParamQuery=o,e.fetchDataset=y,e.fetchFullQuery=function(e){"string"==typeof e&&(e={dataset:e});var t=n(e,"filter")?e.filter:null;if(t){var r=Object.keys(t);return g(o(e,t),!1).then((function(e){return"error"===e.class?e:g(s(l(e),r),!1).then((function(t){return"error"===t.class?t:o(e,t,r)}))}))}return g(e,!1).then((function(e){return e}))},e.fetchQuery=g,e.getEmptyDataset=function(e){var a=n(e,"lang")?e.lang:r,l=n(e,"dataset")?e.dataset:null,i={lang:a.toUpperCase(),datasetId:l},o=Object.keys(e.filter),s=o.map((function(t){return e.filter[t].length})),c={};o.forEach((function(t){c[t]={label:e.label.dimension[t],category:{index:e.filter[t],label:{}}},e.filter[t].forEach((function(r,a){Object.defineProperty(c[t].category.label,r,{value:e.label.category[t][a]})}))}));var u={version:"2.0",class:"dataset",label:e.label.dataset,extension:i,id:o,size:s,dimension:c,value:[]},y=t(u);return f(y),y},e.getStatusLabel=function(e,t){return e.extension.status.label[t]},e.getURL=u,e.lastPeriodQuery=i,e.removeParamQuery=s,e.removeTimeQuery=function(e){return s(e,["time","lastTimePeriod","sinceTimePeriod"])},e.setRole=f,e.simpleQuery=l,e.version="1.0.5",e}({},JSONstat);
